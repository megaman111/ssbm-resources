<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Notes - Megaman's Archive</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .back-link { display: inline-block; margin-top: 1rem; color: #667eea; text-decoration: none; font-weight: 600; background: #f5f5f7; padding: 0.75rem 1.5rem; border-radius: 8px; border: 2px solid #667eea; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); }
        .back-link:hover { background: #667eea; color: white; }
        
        .add-note-form {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .export-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .export-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-right: 1rem;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
        }
        
        .import-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .import-btn:hover {
            transform: translateY(-2px);
        }
        
        #fileInput {
            display: none;
        }
        
        .notes-container {
            display: grid;
            gap: 1.5rem;
        }
        
        .note-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .note-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f5f5f7;
        }
        
        .note-header img {
            width: 40px;
            height: 40px;
        }
        
        .note-player {
            font-size: 1.25rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .note-content {
            color: #333;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .note-date {
            font-size: 0.875rem;
            color: #999;
            margin-top: 1rem;
        }
        
        .note-actions {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
        }
        
        .edit-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .edit-btn:hover {
            background: #5568d3;
        }
        
        .delete-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .delete-btn:hover {
            background: #cc0000;
        }
        
        .save-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .save-btn:hover {
            background: #45a049;
        }
        
        .cancel-btn {
            background: #999;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        .cancel-btn:hover {
            background: #777;
        }
        
        .edit-mode .note-content {
            display: none;
        }
        
        .edit-mode .edit-form {
            display: block;
        }
        
        .edit-form {
            display: none;
        }
        
        .edit-form input,
        .edit-form select,
        .edit-form textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            margin-bottom: 1rem;
        }
        
        .edit-form textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .filter-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .filter-section select {
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            margin-right: 1rem;
        }
        
        .character-icons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .char-filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #667eea;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .char-filter-btn:hover,
        .char-filter-btn.active {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <video id="video-background" autoplay loop muted playsinline>
        <source src="MainMenuLoop720p24fps.webm" type="video/webm">
    </video>
    <div id="video-overlay"></div>
    
    <header>
        <div class="container">
            <h1><img src="https://i.imgur.com/2WVNM7m.png" alt="Fox" style="width: 48px; height: 48px; vertical-align: middle; margin-right: 0.5rem;"> Player Notes - Megaman's Archive</h1>
            <p>Personal notes and gameplans against specific players</p>
            <a href="way-of-fox.html" class="back-link">‚Üê Back to The Way of Fox</a>
        </div>
    </header>

    <main class="container">
        <div class="export-section">
            <h3>üíæ Save Your Notes</h3>
            <p style="color: #666; margin-bottom: 1rem;">After adding or editing notes, export the JSON file and replace player-notes.json in your repo, then push to GitHub.</p>
            <button class="export-btn" onclick="exportNotes()">üì• Export Notes (Download JSON)</button>
            <button class="import-btn" onclick="document.getElementById('fileInput').click()">üì§ Import Notes (Load JSON)</button>
            <input type="file" id="fileInput" accept=".json" onchange="importNotes(event)">
        </div>
        
        <div class="add-note-form">
            <h2>Add New Player Note</h2>
            <form id="noteForm">
                <div class="form-group">
                    <label for="playerName">Player Name</label>
                    <input type="text" id="playerName" placeholder="e.g., Mango, Leffen, Zain..." required>
                </div>
                
                <div class="form-group">
                    <label for="character">Character</label>
                    <select id="character" required>
                        <option value="">Select Character</option>
                        <option value="Fox">Fox</option>
                        <option value="Falco">Falco</option>
                        <option value="Marth">Marth</option>
                        <option value="Sheik">Sheik</option>
                        <option value="Peach">Peach</option>
                        <option value="Jigglypuff">Jigglypuff</option>
                        <option value="Captain Falcon">Captain Falcon</option>
                        <option value="Samus">Samus</option>
                        <option value="Ice Climbers">Ice Climbers</option>
                        <option value="Pikachu">Pikachu</option>
                        <option value="Yoshi">Yoshi</option>
                        <option value="Luigi">Luigi</option>
                        <option value="Ganondorf">Ganondorf</option>
                        <option value="Dr. Mario">Dr. Mario</option>
                        <option value="Donkey Kong">Donkey Kong</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes" placeholder="What does this player like to do? Tendencies, habits, gameplan notes, lessons learned..." required></textarea>
                </div>
                
                <button type="submit" class="submit-btn">Add Note</button>
            </form>
        </div>
        
        <div class="filter-section">
            <h3>Filter by Character</h3>
            <div class="character-icons">
                <button class="char-filter-btn active" data-char="all">All</button>
                <button class="char-filter-btn" data-char="Fox">Fox</button>
                <button class="char-filter-btn" data-char="Falco">Falco</button>
                <button class="char-filter-btn" data-char="Marth">Marth</button>
                <button class="char-filter-btn" data-char="Sheik">Sheik</button>
                <button class="char-filter-btn" data-char="Peach">Peach</button>
                <button class="char-filter-btn" data-char="Jigglypuff">Puff</button>
                <button class="char-filter-btn" data-char="Captain Falcon">Falcon</button>
                <button class="char-filter-btn" data-char="Samus">Samus</button>
                <button class="char-filter-btn" data-char="Ice Climbers">ICs</button>
            </div>
        </div>
        
        <div class="notes-container" id="notesContainer">
            <!-- Notes will be dynamically added here -->
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Megaman's Player Notes Archive</p>
        </div>
    </footer>

    <script>
        const characterIcons = {
            'Fox': 'https://i.imgur.com/2WVNM7m.png',
            'Falco': 'https://i.imgur.com/dbyctg5.png',
            'Marth': 'https://i.imgur.com/HJT5ZTS.png',
            'Sheik': 'https://i.imgur.com/0TAZZIy.png',
            'Peach': 'https://i.imgur.com/fFLSjd8.png',
            'Jigglypuff': 'https://i.imgur.com/AzFEkw2.png',
            'Captain Falcon': 'https://i.imgur.com/fcaKRdi.png',
            'Samus': 'https://i.imgur.com/Yd9DP9r.png',
            'Ice Climbers': 'https://i.imgur.com/iHFuxww.png',
            'Pikachu': 'https://i.imgur.com/0GZF02r.png',
            'Yoshi': 'https://i.imgur.com/XskW1p3.png',
            'Luigi': 'https://i.imgur.com/uM1DTyz.png',
            'Ganondorf': 'https://i.imgur.com/l9xQfyT.png',
            'Dr. Mario': 'https://i.imgur.com/okOuokD.png',
            'Donkey Kong': 'https://i.imgur.com/2hdsXlA.png'
        };

        let currentFilter = 'all';
        let notes = [];

        // Load notes from JSON file
        async function loadNotesFromFile() {
            try {
                const response = await fetch('player-notes.json');
                if (response.ok) {
                    notes = await response.json();
                    displayNotes();
                } else {
                    console.log('No notes file found, starting fresh');
                    notes = [];
                    displayNotes();
                }
            } catch (error) {
                console.log('Error loading notes:', error);
                notes = [];
                displayNotes();
            }
        }

        // Load notes (kept for compatibility)
        function loadNotes() {
            return notes;
        }

        // Save notes (kept for compatibility)
        function saveNotes(newNotes) {
            notes = newNotes;
        }

        // Export notes as JSON file
        function exportNotes() {
            const dataStr = JSON.stringify(notes, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'player-notes.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('Notes exported! Replace the player-notes.json file in your repo with this downloaded file, then commit and push to GitHub.');
        }

        // Import notes from JSON file
        function importNotes(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedNotes = JSON.parse(e.target.result);
                    notes = importedNotes;
                    displayNotes();
                    alert('Notes imported successfully!');
                } catch (error) {
                    alert('Error importing notes. Please make sure the file is valid JSON.');
                }
            };
            reader.readAsText(file);
        }

        // Display notes
        function displayNotes() {
            const notes = loadNotes();
            const container = document.getElementById('notesContainer');
            
            const filteredNotes = currentFilter === 'all' 
                ? notes 
                : notes.filter(note => note.character === currentFilter);
            
            if (filteredNotes.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 2rem;">No notes yet. Add your first player note above!</p>';
                return;
            }
            
            container.innerHTML = filteredNotes.map((note, index) => {
                const originalIndex = notes.indexOf(note);
                return `
                <div class="note-card" id="note-${originalIndex}">
                    <div class="note-actions">
                        <button class="edit-btn" onclick="editNote(${originalIndex})">Edit</button>
                        <button class="delete-btn" onclick="deleteNote(${originalIndex})">Delete</button>
                    </div>
                    <div class="note-header">
                        <img src="${characterIcons[note.character]}" alt="${note.character}">
                        <div>
                            <div class="note-player">${note.playerName}</div>
                            <div style="color: #667eea; font-weight: 600;">${note.character}</div>
                        </div>
                    </div>
                    <div class="note-content">${note.notes}</div>
                    <div class="edit-form">
                        <input type="text" id="edit-player-${originalIndex}" value="${note.playerName}" placeholder="Player Name">
                        <select id="edit-char-${originalIndex}">
                            <option value="Fox" ${note.character === 'Fox' ? 'selected' : ''}>Fox</option>
                            <option value="Falco" ${note.character === 'Falco' ? 'selected' : ''}>Falco</option>
                            <option value="Marth" ${note.character === 'Marth' ? 'selected' : ''}>Marth</option>
                            <option value="Sheik" ${note.character === 'Sheik' ? 'selected' : ''}>Sheik</option>
                            <option value="Peach" ${note.character === 'Peach' ? 'selected' : ''}>Peach</option>
                            <option value="Jigglypuff" ${note.character === 'Jigglypuff' ? 'selected' : ''}>Jigglypuff</option>
                            <option value="Captain Falcon" ${note.character === 'Captain Falcon' ? 'selected' : ''}>Captain Falcon</option>
                            <option value="Samus" ${note.character === 'Samus' ? 'selected' : ''}>Samus</option>
                            <option value="Ice Climbers" ${note.character === 'Ice Climbers' ? 'selected' : ''}>Ice Climbers</option>
                            <option value="Pikachu" ${note.character === 'Pikachu' ? 'selected' : ''}>Pikachu</option>
                            <option value="Yoshi" ${note.character === 'Yoshi' ? 'selected' : ''}>Yoshi</option>
                            <option value="Luigi" ${note.character === 'Luigi' ? 'selected' : ''}>Luigi</option>
                            <option value="Ganondorf" ${note.character === 'Ganondorf' ? 'selected' : ''}>Ganondorf</option>
                            <option value="Dr. Mario" ${note.character === 'Dr. Mario' ? 'selected' : ''}>Dr. Mario</option>
                            <option value="Donkey Kong" ${note.character === 'Donkey Kong' ? 'selected' : ''}>Donkey Kong</option>
                        </select>
                        <textarea id="edit-notes-${originalIndex}">${note.notes}</textarea>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="save-btn" onclick="saveEdit(${originalIndex})">Save</button>
                            <button class="cancel-btn" onclick="cancelEdit(${originalIndex})">Cancel</button>
                        </div>
                    </div>
                    <div class="note-date">Added: ${new Date(note.date).toLocaleDateString()}</div>
                </div>
            `;
            }).join('');
        }

        // Add new note
        document.getElementById('noteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const playerName = document.getElementById('playerName').value;
            const character = document.getElementById('character').value;
            const notes = document.getElementById('notes').value;
            
            const newNote = {
                playerName,
                character,
                notes,
                date: new Date().toISOString()
            };
            
            const allNotes = loadNotes();
            allNotes.unshift(newNote); // Add to beginning
            saveNotes(allNotes);
            
            // Clear form
            document.getElementById('noteForm').reset();
            
            // Refresh display
            displayNotes();
        });

        // Delete note
        function deleteNote(index) {
            if (confirm('Are you sure you want to delete this note?')) {
                const notes = loadNotes();
                notes.splice(index, 1);
                saveNotes(notes);
                displayNotes();
            }
        }

        // Edit note
        function editNote(index) {
            const noteCard = document.getElementById(`note-${index}`);
            noteCard.classList.add('edit-mode');
        }

        // Cancel edit
        function cancelEdit(index) {
            const noteCard = document.getElementById(`note-${index}`);
            noteCard.classList.remove('edit-mode');
        }

        // Save edit
        function saveEdit(index) {
            const playerName = document.getElementById(`edit-player-${index}`).value;
            const character = document.getElementById(`edit-char-${index}`).value;
            const notes = document.getElementById(`edit-notes-${index}`).value;

            if (!playerName || !character || !notes) {
                alert('Please fill in all fields');
                return;
            }

            const allNotes = loadNotes();
            allNotes[index] = {
                ...allNotes[index],
                playerName,
                character,
                notes
            };
            saveNotes(allNotes);
            displayNotes();
        }

        // Filter functionality
        document.querySelectorAll('.char-filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.char-filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.char;
                displayNotes();
            });
        });

        // Initial load
        loadNotesFromFile();
    </script>
</body>
</html>
